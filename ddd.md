## ドメイン駆動設計 モデリング/実装入門勉強会

#### 資料
https://www.slideshare.net/koichiromatsuoka/202038
#### サンプルコード
https://github.com/little-hands/ddd-task-management-sample
#### 参考NOTE
https://note.com/loglass_sakamoto/n/n7472f7df0892

### DDDとは
ソフトウェアで問題を解決する対象が「ドメイン」
domainlanguage.com

DDDは
「ドメインモデリングによってソフトウェアの価値を高める」
ことを目指す

DDDの目的はコード品質のさらに先にある
コード品質を高めつつ、モデリングの効果を高める

### モデルとは

「モデル」とは
→問題解決のために、物事の特定の側面を抽象化したもの

ドメインモデル（ドメインの問題を解決するためのモデル）→データモデル

抽象化とは
→必要な要素はモデルに取込、不要な要素は取り込みたくない

良いモデルとは？
→問題解決ができるモデル
良くないモデルとは？
→問題解決ができないモデル

モデルが良くないと運用でカバーすることになってしまう
UXが原因で離脱してしまったら、売れなければプロダクトがなくなる

モデルがイケていないとどんなにコードが素晴らしくても売れない
そのために、ドメインに詳しい人から知識を得る（使っている人や運用している人）
運用した知見をモデルにフォードバックして改善する
モデルは最初から完成しない、改善していくもの

モデルとコードが乖離すると、変更が正しく反映されているかわからなくなる

モデルをそのまま表現したコードとなるのが望ましい
→「オブジェクト」でモデルを表現する

モデルは継続的に改善したい
→コードにも継続的に反映しないといけない
→頻繁な変更に耐えるには拡張性の高い設計が必要
→EntityやRepositoryなどのデザインパターン

ドメインモデリングの方法
┗リレーションシップ駆動要件分析
┗ユースケース駆動分析設計
┗ユースケース図（UML）とドメインモデル図

ユースケースの具体化・言語化
→具体化しないとどのようなモデルを作ればよいのかわからない
→どのような問題かが定義できないとそれに対する解決策も定義できない

ドメインモデル図作成作業の範囲を狭める
→範囲を限定して、限られた時間でまとまった成果が出せるようにする

ドメインモデル図
┗クラス図の簡易版
┗メソッドは不要
┗属性も代表的なものだけでOK

集約：必ず守りたい強い整合性を持ったオブジェクトのまとまり

### じゃあどうする
- ドメインモデル図の知識がApplication層のクラスに書かれている
→Domain層のクラスに記述するに修正
WhatはApplication層、HowはDomain層に記述する

- Setterがいろんなところから呼ばれていると、Setterのテストで呼ばれている分だけ全てテストしないといけないので、バグりやすくなる

- モデルを生成するパターン、変更するパターンが何かが一目見てわかるのは、とても可読性が良い

- レイヤーによって書くべきことが決まっていると、実装やレビューの時に使える

### 実務での導入
お手本コードを作る
↓
お手本に倣ってコードを書くようにチームに展開する
↓
書くべき内容に迷ったらドメインモデル図を作ってみる
↓
ドメインモデル図を元にリファクタリングしていく

お手本をもとに展開した方が難易度が低い
コードをイメージできてからの方がドメインモデリング化しやすい

DDDのコーディング、モデリング共に1発ではうまくできない
両方口語に経験値をためながら上達していくしかない

DDDでは「モデルを継続的に改善」「モデルの更新をソフトウェアに反映」のアプローチでソフトウェアの価値を高める

### ユースケース図を書くのに適切なツール
plantUML
https://plantuml.com/ja/
