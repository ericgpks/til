DevOps


1. DevOps はまずは人、そしてプロセス、次にツールについて考える。DevOps の変革について成功させるには、文化・自動化・メトリクス・共有の4つが必要。
2. 権力の集中は生産性の低下を招く。権力を持つ人をゲートキーパーと呼ぶ。本来ゲートキーパーを置くことでやりたかったことを自動化する。知らず知らずのうちに危険な操作をしてしまわないように設計すべき。実行する人を制限することでその人にプレッシャーを集中させている。DevOps組織は価値を付加するものは残し、人為的な障壁は取り除く。システムに置き換えられることを実際に置き換えて人はよりインパクトのあることに取り組めるようにする。組織に永続敵な価値をもたらす仕事を最大限行うことに重点をおく。DevOpsは手動による承認よりも自動化を推奨する。ゲートキーパーがプロセスの設計に関わることは大切。全員が現在のプロセスに問題があるという共通認識をもつことが大切。
3. 利用可能だからそのメトリクスを監視しているという状態。企業が収益をあげるためのアプリケーションなのでより深く理解する必要がある。本番環境でどのような動作をするのかを理解することが求められている。システムが期待通りに動いていないと、エラーがないから期待通りに動いているとは限らない。正常な動作とは何かを知ることが求められ、プロダクトを理解し時間をかけて観察することで得られる。ツールに関する知識と会社のプロダクトの知識の組み合わせが求められている。ビジネスの面から理解して価値を付加できなければならない。メトリクスは現在の状態を伝えるのに適している。キューレイテンシとはキュー内での待ち時間。健全な状態とはどのようなものかを定義することが必要。ログは必ず構造化すべき。ログを取ることは複数部門が情報にアクセスできるようになりアプリケーションの状態をリアルタイムで確認することができる。ログメッセージに必要な文脈を詰め込むこと。ログを読む人のことを考えてエラーメッセージを作成する。
4. データに文脈や構造を与えることで情報になる。最初のステップはダッシュボードの対象者を特定する。利用者が何をしようとしているのかをという動機を理解する。ゲージとはどのような見た目でどういう場面で役にたつのだろうか。しきい値によってあるべき値の最大値を示す。ウィジェットは左から右へ、上から下へ重要度の高い順に並べる。ノートウィジェットを用いてそれぞれのメトリクスや解釈について説明する。ダッシュボードの命名も重要。
5. テストのほとんどがユニットテストである。ユニットテストとは個々のユニットまたはコンポーネントに対してかかれたテストのこと。開発者以外の人がユニットテストを書くのは間違っている。E2Eテストの数を制限してビジネスの中核となる機能のみをテストするようにしている。テストケースはユニットテストが失敗したら早めに気がつけるようにするべき。テストによって信頼性を高められていないならそれは役に立っていない。E2Eテストは信頼性に欠けると同時に必要なものでもある。テストカバレッジはテストの品質や何がテストされているのかを示さない。継続的デリバリとは常にデプロイ可能な状態にしておくこと。継続的デプロイのためにはテストやコードレビューが必要になる。デプロイパイプラインとはユニットテストやアプリケーションコードのパッケージ化など、コードの変更を検証する一連の構造化され自動化されたステップのこと。リリースするための要件はできるだけコード化しパイプラインに含めておく。ビルドパイプラインを適切にフェーズ分けすること。
6. アラート疲れについて
7. プロダクトをつくるツールも同様に重要である。投資の欠如を空の道具箱と呼んでいる。システムをどのように管理し扱うかも重要。自動化によって必要に応じて高い頻度で実行でき実行によるばらつきがなくなる。自動化に取り組むことでビジネスの効率化を図ることができる。自動化とツール開発は優先順位が下げられ空き時間に行うタスクに回されがちである。自動化に関する文化を変える計画を立てる必要がある。手動でタスクを行うことに対してノーという。自動タスクのメンテナンス時間を考慮する必要がある。しかしタスクの実行回数と比例はしない。ツールを評価する際にそのツールで自動化が可能になっていなければならない。頻繁に依頼されるタスクについては自動化し依頼者が解決できる方法を構築することでチームの貴重な時間を確保することができる。継続的に学習することは文化を作ることである。学習が不足していると今のやり方に固執してしまい他に良い方法がないかを考えなくなってしまう。学習を他の仕事と同じように扱う。学習のシステムで追跡する必要がある。必要なスキルは組織内に存在し実現する必要があることをチームに支援してもらうことはDevOpsの理念においても重要である。既存の作品を研究し他者から学ぶ。他のチームからスキルを借りることは長期的には望ましいことではない。多くのトレーニングとメンターシップが必要になる。破壊的な行動を取る必要がある場合は可能な限りユーザーに確認すべき。オペレーターが期待しない動作をしないようにする。困難なタスクとは単純ではないが一度やってしまえばその作業は繰り返し可能なものになる。タスクをランクづけする場合は専門家からの視点ではなくそれを実行する人の観点から考えるべき。シンプルなスタート方法は小さなタスクに商店を当てて少しずつ積み重ねていくこと。
8. 業務時間外のデプロイは組織を守るために正当化されがちなアンチパターン。機能は完成した時点で価値を生み出すのではなくリリースされて初めて企業にとっての価値を生み始める。リリースが大きくなるとリスクも大きくなる。デプロイをレイヤに分けて考えないとリリースプロセスで多くのチームにまたがって調整が必要になってしまう。本番前環境はできるだけ本番環境に似たものになるべきである。より正確に反映する。本番環境とステージング環境は決して同じになることはない。ユーザーと並行実行性が異なるためである。エンドユーザーが行う可能性のあるすべてのことを想定できない。
